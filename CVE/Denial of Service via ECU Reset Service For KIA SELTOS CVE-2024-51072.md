# CVE-2024-51072

## Description
A Denial of Service (DoS) vulnerability has been identified in the Unified Diagnostic Services (UDS) implementation of KIA vehicle cluster systems. The vulnerability arises due to insufficient access control or session validation for the UDS Hard Reset service ($11). An attacker with access to the vehicle's diagnostic interface can exploit this service to repeatedly trigger system resets, rendering the instrument cluster temporarily inoperable and disrupting critical vehicle operations

**Vulnerability Score**: **5.3** **Medium** [AV:P/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:H](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:P/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:H&version=3.1)

## Impact
Safety Risks: Loss of cluster functionality may impair driver awareness and decision-making.

Operational Disruption: Temporary unavailability of the cluster ECU during resets affects real-time vehicle data visibility.

Broader System Effects: Extended downtime of the cluster may impact inter-ECU communications and vehicle systems reliant on cluster information.

## Exploitation Details
To exploit the UDS protocol with black box testing approach, identifying the correct CAN IDs for diagnostic requests and responses is essential. For this, we utilized an incremental fuzzing approach within the standard CAN ID range (0x000 to 0x7FF). Using the "Tester Present" ($3E) service as the payload, we captured positive responses to identify the diagnostic request and response CAN ID pairs.

The identified CAN ID pair used for further testing was **0x7C6 (Request) and 0x7CE (Response)**, as shown in the image below

![image](https://github.com/user-attachments/assets/6f1b2fa4-b993-49da-9a98-0c0f6bfd9337)

Once the diagnostic communication was established, we enumerated the UDS services supported by the ECU. This was achieved through 1-byte fuzzing of the UDS service field, which allowed us to capture all positive responses. The supported UDS services for the cluster, including "Communication Control" ($28) and "Hard Reset" ($11), are illustrated in the results below.

![image](https://github.com/user-attachments/assets/48117f90-8307-4806-b2dc-dab936dd2f41)


Among the identified services, we focused on exploiting the Hard Reset ($11) service:
Hard Reset service($11): The Hard Reset service triggers a complete software reset of the target ECU, similar to a "reboot" of a computer.
It stops all current operations and reinitializes the ECU, clearing temporary errors or returning the ECU to its default operational state.

To exploit this service, we initiated repeated Hard Reset diagnostic requests to the instrument cluster in a loop. The cluster responded with a positive acknowledgment to each request, resulting in the cluster becoming inoperable due to the attack.

Below GIF shows cluster's behaviour during attack.

![](https://github.com/nitinronge91/KIA-SELTOS-Cluster-Vulnerabilities/blob/7dfd87c27611c15172ce4daa1fc37b96fdaf66d8/Hard_reset.gif)

The image below shows the cluster's positive acknowledgment to the diagnostic request.

![image](https://github.com/user-attachments/assets/53e5f898-20b4-447d-bd86-6cdefba7ea95)






This vulnerability is highly critical due to its significant potential impact on vehicle safety, security, and functionality.


## Mitigations / Fixes
1. Implement strong authentication and encryption for accessing UDS services Hard Reset($11) using security access($27) service.
2. Use secure diagnostic sessions with robust key management.
