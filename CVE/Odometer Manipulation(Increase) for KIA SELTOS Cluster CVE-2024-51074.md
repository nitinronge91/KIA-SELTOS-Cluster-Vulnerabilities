# CVE-2024-51074

## Description
The KIA Seltos vehicle's CAN communication system lacks adequate security measures, making it vulnerable to exploitation. This vulnerability allows an attacker to tamper with and manipulate the odometer readings by targeting the instrument cluster through the unsecured CAN network.

## Impact
Manipulating odometer readings can have significant consequences across various domains, including vehicle safety, financial fraud,legal compliance and insurance fraud. 

## Exploitation Details
As outlined in the reconnaissance phase, a black-box testing approach was utilized. To identify the specific CAN IDs associated with various functionalities of the vehicle's instrument cluster, we performed a brute-force test over the complete standard CAN ID range (0x000 to 0x7FF). This process helped us determine a set of CAN IDs linked to different operations of the cluster.

Among the identified CAN IDs, one particularly notable ID was 0x386. Upon conducting random fuzzing tests on this CAN ID, we observed that the vehicle speed data displayed on the instrument cluster began to change erratically. With continued fuzzing, it was further noted that the odometer reading started incrementing as well.

This discovery highlighted a critical vulnerability. The images below illustrate the odometer reading before and after the attack, clearly demonstrating how the odometer can be manipulated via this method.

![image](https://github.com/user-attachments/assets/74f7f7c2-535c-498f-b4f2-89f2a6ce7e83)

![](https://github.com/nitinronge91/KIA-SELTOS-Cluster-Vulnerabilities/blob/main/GIF_20241120_102728_427.gif)


## Attack confirmation via UDS service
During the penetration testing of the instrument cluster's UDS (Unified Diagnostic Services) protocol, we validated the feasibility of reading manipulated odometer readings via specific UDS services. To identify the data storage mechanism for the odometer, we utilized the UDS service 'Read Data by Identifier (0x22)' to enumerate all supported Data Identifiers (DIDs).

Given the black-box nature of the testing, we systematically fuzzed the entire range of 2-byte data values for supported DIDs to determine their functionality. After conducting the odometer manipulation attack described earlier, we compared the data retrieved from all DIDs before and after the attack.

The only difference observed was in the data corresponding to DID 0x0080. Specifically, the last few bytes of the response to this DID were altered post-attack. To confirm its relevance, we converted the hexadecimal value of these bytes into decimal format and whoooooo ...!!! The resulting decimal value matched the odometer reading displayed on the instrument cluster.

This confirmed that DID 0x0080 is responsible for storing the odometer reading in the cluster's non-volatile memory. The images below illustrate the UDS operations, showing the odometer values stored in the memory before and after the manipulation attack.Even after power cycle the updated value of odomter is displayed on cluster that means it is stored in cluster's non volatile memory.

![image](https://github.com/user-attachments/assets/afb68766-f522-4666-b695-01ed1d3e4d25)




## Mitigations / Fixes
Provide suggestions for fixing or mitigating the vulnerability.

## References
- [NVD Entry for CVE-2023-12345](https://nvd.nist.gov/vuln/detail/CVE-2023-12345)
- [Vendor Advisory](https://examplevendor.com/advisory/12345)
